---
/**
 * NewsCard Component
 * Clean card design for news items with category colors
 */
import type { NewsItem } from '../../data/news/types';
import { useTranslations } from '../../i18n/utils';

interface Props {
  item: NewsItem;
  lang: string;
  index?: number;
}

const { item, lang, index = 0 } = Astro.props;
const t = useTranslations(lang as 'en' | 'es' | 'pt');

// Category styling - background and text colors
const categoryStyles = {
  certifications: {
    bg: 'bg-emerald-50 dark:bg-emerald-900/20',
    border: 'border-emerald-200 dark:border-emerald-800/50',
    badge: 'bg-emerald-100 dark:bg-emerald-900/50 text-emerald-700 dark:text-emerald-300',
    hover: 'hover:border-emerald-300 dark:hover:border-emerald-700',
    icon: 'text-emerald-500',
  },
  scholarships: {
    bg: 'bg-amber-50 dark:bg-amber-900/20',
    border: 'border-amber-200 dark:border-amber-800/50',
    badge: 'bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300',
    hover: 'hover:border-amber-300 dark:hover:border-amber-700',
    icon: 'text-amber-500',
  },
  events: {
    bg: 'bg-blue-50 dark:bg-blue-900/20',
    border: 'border-blue-200 dark:border-blue-800/50',
    badge: 'bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300',
    hover: 'hover:border-blue-300 dark:hover:border-blue-700',
    icon: 'text-blue-500',
  },
  announcements: {
    bg: 'bg-violet-50 dark:bg-violet-900/20',
    border: 'border-violet-200 dark:border-violet-800/50',
    badge: 'bg-violet-100 dark:bg-violet-900/50 text-violet-700 dark:text-violet-300',
    hover: 'hover:border-violet-300 dark:hover:border-violet-700',
    icon: 'text-violet-500',
  },
};

const styles = categoryStyles[item.category];
const formattedDate = new Intl.DateTimeFormat(lang, {
  month: 'short',
  day: 'numeric',
  year: 'numeric',
}).format(item.publishedAt);

// Category icons
const categoryIcons = {
  certifications: 'M4.26 10.147a60.436 60.436 0 00-.491 6.347A48.627 48.627 0 0112 20.904a48.627 48.627 0 018.232-4.41 60.46 60.46 0 00-.491-6.347m-15.482 0a50.57 50.57 0 00-2.658-.813A59.905 59.905 0 0112 3.493a59.902 59.902 0 0110.399 5.84c-.896.248-1.783.52-2.658.814m-15.482 0A50.697 50.697 0 0112 13.489a50.702 50.702 0 017.74-3.342M6.75 15a.75.75 0 100-1.5.75.75 0 000 1.5zm0 0v-3.675A55.378 55.378 0 0112 8.443m-7.007 11.55A5.981 5.981 0 006.75 15.75v-1.5',
  scholarships: 'M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z',
  events: 'M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5',
  announcements: 'M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 110-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 01-1.44-4.282m3.102.069a18.03 18.03 0 01-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 018.835 2.535M10.34 6.66a23.847 23.847 0 008.835-2.535m0 0A23.74 23.74 0 0018.795 3m.38 1.125a23.91 23.91 0 011.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-1.125a23.91 23.91 0 001.014-5.395m0-3.46c.495.413.811 1.035.811 1.73 0 .695-.316 1.317-.811 1.73m0-3.46a24.347 24.347 0 010 3.46',
};
---

<article
  class="news-card group animate-fade-in-up"
  data-category={item.category}
  style={`animation-delay: ${index * 50}ms`}
>
  <a
    href={item.url}
    target="_blank"
    rel="noopener noreferrer"
    class={`block h-full p-4 sm:p-5 rounded-xl border transition-all duration-200 ${styles.bg} ${styles.border} ${styles.hover} hover:shadow-lg hover:-translate-y-0.5`}
  >
    <!-- Header: Category badge + Date -->
    <div class="flex items-center justify-between mb-3">
      <span class={`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-medium ${styles.badge}`}>
        <svg class={`w-3.5 h-3.5 ${styles.icon}`} fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d={categoryIcons[item.category]} />
        </svg>
        {t(`news.category.${item.category}`)}
      </span>
      <time class="text-xs text-neutral-500 dark:text-neutral-400">
        {formattedDate}
      </time>
    </div>

    <!-- Title -->
    <h3 class="text-base font-semibold text-neutral-900 dark:text-white mb-2 line-clamp-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors leading-snug">
      {item.title}
    </h3>

    <!-- Description -->
    <p class="text-sm text-neutral-600 dark:text-neutral-400 line-clamp-2 leading-relaxed mb-4">
      {item.description}
    </p>

    <!-- Footer: Source + Read more -->
    <div class="flex items-center justify-between mt-auto pt-3 border-t border-neutral-200/50 dark:border-neutral-700/50">
      <span class="text-xs text-neutral-500 dark:text-neutral-400 truncate max-w-[60%]">
        {item.source}
      </span>
      <span class="inline-flex items-center gap-1 text-xs font-medium text-primary-600 dark:text-primary-400 group-hover:gap-2 transition-all">
        {t('news.readMore')}
        <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </span>
    </div>
  </a>
</article>

<style>
  .news-card.hidden {
    display: none;
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in-up {
    animation: fade-in-up 0.4s ease-out forwards;
  }
</style>
